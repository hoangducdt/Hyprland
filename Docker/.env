# =============================================================================
# DOCKER COMPOSE ENVIRONMENT VARIABLES
# =============================================================================
# Copy this file to .env and fill in all values
# NEVER commit .env to git!

# =============================================================================
# DOMAIN CONFIGURATION
# =============================================================================
DOMAIN=localhost
# Example: DOMAIN=myserver.hoangducdt.net

# =============================================================================
# DATABASE PASSWORDS
# =============================================================================
# Generate strong passwords (32+ chars) using:
# PowerShell: [Convert]::ToBase64String((1..32 | ForEach-Object { Get-Random -Maximum 256 }))
# OpenSSL: openssl rand -base64 32

POSTGRES_PASSWORD=
REDIS_PASSWORD=
NPM_DB_PASSWORD=
MYSQL_ROOT_PASSWORD=

# =============================================================================
# ADMIN CREDENTIALS
# =============================================================================
# Used for: Grafana, n8n, Paperless, Snippet Box

ADMIN_PASSWORD=

# =============================================================================
# AUTHELIA SSO SECRETS
# =============================================================================
# Generate using: openssl rand -hex 64

AUTHELIA_JWT_SECRET=
AUTHELIA_SESSION_SECRET=
AUTHELIA_STORAGE_KEY=

# =============================================================================
# APPLICATION SECRETS
# =============================================================================

# Paperless-ngx
PAPERLESS_SECRET_KEY=

# Homarr
HOMARR_SECRET=

# Open WebUI
WEBUI_SECRET_KEY=

# Watchtower API (optional)
WATCHTOWER_API_TOKEN=watchtower

# =============================================================================
# CLOUDFLARE DDNS
# =============================================================================
# Get API Token from: https://dash.cloudflare.com/profile/api-tokens
# Required permissions: Zone.DNS (Edit)

CLOUDFLARE_API_KEY=
CLOUDFLARE_ZONE=yourdomain.com
CLOUDFLARE_SUBDOMAIN=@

# =============================================================================
# NOTIFICATIONS (Optional)
# =============================================================================

# Watchtower notifications
# Discord: discord://webhook_id/webhook_token
# Telegram: telegram://token@telegram
# Email: smtp://user:pass@host:port/?from=sender&to=recipient
WATCHTOWER_NOTIFICATION_URL=

# Diun webhook
DIUN_WEBHOOK_URL=

# Autoheal webhook
AUTOHEAL_WEBHOOK_URL=

# =============================================================================
# AI/LLM CONFIGURATION (Optional)
# =============================================================================

# LM Studio (Windows host)
OPENAI_API_BASE_URL=http://host.docker.internal:1234/v1
OPENAI_API_KEY=lm-studio

# Ollama (if installed)
# OLLAMA_BASE_URL=http://host.docker.internal:11434

# =============================================================================
# SSH/TERMINAL CONFIGURATION (Optional)
# =============================================================================

SSH_HOST=host.docker.internal
SSH_PORT=22
SSH_USER=your-username

# =============================================================================
# MONITORING (Optional)
# =============================================================================

# Netdata Cloud (optional)
NETDATA_CLAIM_TOKEN=
NETDATA_CLAIM_ROOMS=

# CrowdSec enrollment (optional)
CROWDSEC_ENROLL_KEY=
CROWDSEC_BOUNCER_KEY=

# =============================================================================
# SECURITY CHECKLIST
# =============================================================================
# [ ] All passwords are 32+ characters
# [ ] All secrets are randomly generated
# [ ] No default passwords (admin, password, 123456)
# [ ] .env is in .gitignore
# [ ] .env is backed up securely
# [ ] Domain is configured correctly
# [ ] Cloudflare API token has correct permissions

# =============================================================================
# QUICK SETUP COMMANDS
# =============================================================================
#
# 1. Copy this file:
#    cp .env.example .env
#
# 2. Generate all passwords at once (PowerShell):
#    Get-Content .env | ForEach-Object { 
#      if ($_ -match '^([A-Z_]+)=$') { 
#        "$($matches[1])=$([Convert]::ToBase64String((1..32 | ForEach-Object { Get-Random -Maximum 256 })))" 
#      } else { $_ } 
#    } | Set-Content .env.tmp && Move-Item .env.tmp .env -Force
#
# 3. Edit domain and other settings:
#    notepad .env
#
# 4. Validate:
#    docker compose config
#
# 5. Start services:
#    docker compose up -d
#
# =============================================================================
# =============================================================================
# STABLE DIFFUSION CONFIGURATION
# =============================================================================
# Hardware: RTX 3060 12GB VRAM
# - Can run SD 1.5 easily (batch 2-4)
# - Can run SDXL with --medvram (batch 1)
# - xFormers enabled for 20-30% speed boost

# Stable Diffusion ports
# WebUI: http://localhost:7860
# ComfyUI: http://localhost:8188

# CLI Args already optimized in docker-compose.yml:
# --medvram: Optimize for 12GB VRAM
# --xformers: Memory efficient attention
# --opt-split-attention: Further memory optimization
# --no-half-vae: Better quality
# --api: Enable API access

# =============================================================================
# HARDWARE OPTIMIZATIONS APPLIED
# =============================================================================
# From install.sh system setup:
# - CPU: Ryzen 7 5800X (8C/16T) - Performance governor
# - GPU: RTX 3060 12GB - NVIDIA optimizations applied
# - RAM: 32GB recommended
# - Network: Static IP 192.168.1.2/24
# - DNS: Cloudflare DNS over TLS

# Docker resource limits optimized for Ryzen 7 5800X:
# - Paperless: 4 workers x 2 threads = 8 parallel tasks
# - PostgreSQL: 2 CPUs, 2GB RAM, 512MB shared memory
# - Redis: 512MB maxmemory
# - n8n: 2 CPUs, 2GB RAM
# - Stable Diffusion: 8 CPUs, 16GB RAM, GPU passthrough
# - ComfyUI: 8 CPUs, 16GB RAM, GPU passthrough

# =============================================================================
# FIRST TIME SETUP
# =============================================================================
# 1. Ensure Docker Desktop is running:
#    docker info
#
# 2. Install nvidia-container-toolkit (if not done):
#    sudo pacman -S nvidia-container-toolkit
#    # Then restart Docker Desktop
#
# 3. Test GPU in Docker:
#    docker run --rm --gpus all nvidia/cuda:12.2.0-base-ubuntu22.04 nvidia-smi
#
# 4. Copy this file:
#    cp _env .env
#
# 5. Generate passwords:
#    for var in POSTGRES_PASSWORD REDIS_PASSWORD NPM_DB_PASSWORD MYSQL_ROOT_PASSWORD ADMIN_PASSWORD PAPERLESS_SECRET_KEY WEBUI_SECRET_KEY; do
#      echo "$var=$(openssl rand -base64 32)" >> .env
#    done
#
# 6. Edit .env with your settings:
#    nano .env
#
# 7. Set correct permissions:
#    chmod 600 .env
#
# 8. Validate:
#    docker compose config
#
# 9. Start services:
#    docker compose up -d
#
# 10. Check logs:
#     docker compose logs -f

# =============================================================================
# STABLE DIFFUSION FIRST RUN
# =============================================================================
# 1. Access WebUI: http://localhost:7860
#
# 2. Download models (optional):
#    # SD 1.5 (4GB)
#    docker exec -it stable-diffusion-webui bash
#    cd /data/models/Stable-diffusion
#    wget https://huggingface.co/runwayml/stable-diffusion-v1-5/resolve/main/v1-5-pruned-emaonly.safetensors
#    
#    # Or SDXL (6.5GB)
#    wget https://huggingface.co/stabilityai/stable-diffusion-xl-base-1.0/resolve/main/sd_xl_base_1.0.safetensors
#
# 3. Install extensions via WebUI:
#    - ControlNet
#    - Dynamic Prompts
#    - Ultimate SD Upscale
#    - Tag Autocomplete
#
# 4. Recommended settings for RTX 3060:
#    SD 1.5: 512x512 or 768x768, batch 2-4, CFG 7-11, steps 20-30
#    SDXL: 1024x1024, batch 1, CFG 7-9, steps 25-35

# =============================================================================
# SERVICE ACCESS
# =============================================================================
# Nginx Proxy Manager: http://localhost:81 (admin@example.com / changeme - CHANGE THIS!)
# Paperless-ngx: Configure via NPM
# Stable Diffusion: http://localhost:7860
# ComfyUI: http://localhost:8188
# n8n: Configure via NPM
# Open WebUI: Configure via NPM
# Duplicati: Configure via NPM
# FileBrowser: Configure via NPM
# Syncthing: Configure via NPM
# Netdata: Configure via NPM
# IT-Tools: Configure via NPM
# Watchtower: http://localhost:8080 (metrics)

# =============================================================================
